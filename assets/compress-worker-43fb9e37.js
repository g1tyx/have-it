var I=Object.defineProperty;var J=(p,h,c)=>h in p?I(p,h,{enumerable:!0,configurable:!0,writable:!0,value:c}):p[h]=c;var v=(p,h,c)=>(J(p,typeof h!="symbol"?h+"":h,c),c),O=(p,h,c)=>{if(!h.has(p))throw TypeError("Cannot "+c)};var x=(p,h,c)=>(O(p,h,"read from private field"),c?c.call(p):h.get(p)),j=(p,h,c)=>{if(h.has(p))throw TypeError("Cannot add the same private member more than once");h instanceof WeakSet?h.add(p):h.set(p,c)};var _=(p,h,c)=>(O(p,h,"access private method"),c);(function(){var k,g,A;"use strict";const p={};let h=0;function c(f,e,s,...i){return h++,new Promise((w,m)=>(f.postMessage({__workhole:!0,action:"command",id:h,command:s,name:e,args:i}),p[h]={resolve:w,reject:m}))}class C{constructor(e,s=`workhole${++h}`){j(this,g);v(this,"exports",[]);v(this,"imports",new Set);j(this,k,{});this.worker=e,this.name=s,e.addEventListener("message",i=>{i.data.__workhole&&_(this,g,A).call(this,i.data)})}export(e,s){if(typeof e!="object")throw new Error("Can only export objects");if(s===void 0)throw new Error("Can't export object without a name");this.worker.postMessage({__workhole:!0,action:"export",name:s}),this.exports[s]=e}revoke(e){this.worker.postMessage({__workhole:!0,action:"revoke",name:e}),delete this.exports[e]}import(e,s=!1){return new Proxy({},{get:(i,w)=>{if(w==="then"&&s){s=!1;return}return c.bind(i,this.worker,e,w)}})}expectExport(e){return this.imports.has(e)?Promise.resolve(this.import(e,!0)):new Promise((s,i)=>{x(this,k)[e]={resolve:s,reject:i}})}onexport(e){}onrevoke(e){}}k=new WeakMap,g=new WeakSet,A=function(e){var s,i,w;if(e.action==="export"){this.imports.add(e.name),x(this,k)[e.name]&&(x(this,k)[e.name].resolve(this.import(e.name,!0)),delete x(this,k)[e.name]),this.onexport(e.name);return}if(e.action==="revoke"){this.imports.delete(e.name),this.onrevoke(e.name);return}if(e.action==="command"){const m=this.exports[e.name];if(m===void 0)throw new Error(`"${this.name}" does not export "${e.name}"`);this.worker.postMessage({__workhole:!0,action:"result",id:e.id,result:(i=(s=m[e.command])==null?void 0:s.call)==null?void 0:i.call(s,m,...e.args)});return}if(e.action==="result"){(w=p[e.id])==null||w.resolve(e.result),delete p[e.id];return}};var P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function E(f){if(f==null)return"";let e=S(f,6,s=>P.charAt(s));switch(e.length%4){default:case 0:return e;case 1:return e+"===";case 2:return e+"==";case 3:return e+"="}}function S(f,e,s){if(f==null)return"";let i=[],w={},m={},n,y,t,d="",u="",b="",a=2,M=3,l=2,r=0,o=0;for(y=0;y<f.length;y+=1)if(d=f.charAt(y),Object.prototype.hasOwnProperty.call(w,d)||(w[d]=M++,m[d]=!0),b=u+d,Object.prototype.hasOwnProperty.call(w,b))u=b;else{if(Object.prototype.hasOwnProperty.call(m,u)){if(u.charCodeAt(0)<256){for(n=0;n<l;n++)r=r<<1,o==e-1?(o=0,i.push(s(r)),r=0):o++;for(t=u.charCodeAt(0),n=0;n<8;n++)r=r<<1|t&1,o==e-1?(o=0,i.push(s(r)),r=0):o++,t=t>>1}else{for(t=1,n=0;n<l;n++)r=r<<1|t,o==e-1?(o=0,i.push(s(r)),r=0):o++,t=0;for(t=u.charCodeAt(0),n=0;n<16;n++)r=r<<1|t&1,o==e-1?(o=0,i.push(s(r)),r=0):o++,t=t>>1}a--,a==0&&(a=Math.pow(2,l),l++),delete m[u]}else for(t=w[u],n=0;n<l;n++)r=r<<1|t&1,o==e-1?(o=0,i.push(s(r)),r=0):o++,t=t>>1;a--,a==0&&(a=Math.pow(2,l),l++),w[b]=M++,u=String(d)}if(u!==""){if(Object.prototype.hasOwnProperty.call(m,u)){if(u.charCodeAt(0)<256){for(n=0;n<l;n++)r=r<<1,o==e-1?(o=0,i.push(s(r)),r=0):o++;for(t=u.charCodeAt(0),n=0;n<8;n++)r=r<<1|t&1,o==e-1?(o=0,i.push(s(r)),r=0):o++,t=t>>1}else{for(t=1,n=0;n<l;n++)r=r<<1|t,o==e-1?(o=0,i.push(s(r)),r=0):o++,t=0;for(t=u.charCodeAt(0),n=0;n<16;n++)r=r<<1|t&1,o==e-1?(o=0,i.push(s(r)),r=0):o++,t=t>>1}a--,a==0&&(a=Math.pow(2,l),l++),delete m[u]}else for(t=w[u],n=0;n<l;n++)r=r<<1|t&1,o==e-1?(o=0,i.push(s(r)),r=0):o++,t=t>>1;a--,a==0&&(a=Math.pow(2,l),l++)}for(t=2,n=0;n<l;n++)r=r<<1|t&1,o==e-1?(o=0,i.push(s(r)),r=0):o++,t=t>>1;for(;;)if(r=r<<1,o==e-1){i.push(s(r));break}else o++;return i.join("")}const $=new C(self),F={compress(f){const e=JSON.stringify(f);return E(e)}};$.export(F,"compressor")})();
